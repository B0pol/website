---
layout: post
title: "NewPipe 0.20.0 released: A new minor version, a new unified player, a new notification experience... A lot new!"
short: "NewPipe 0.20.0 released"
date: 2020-09-15 05:00:00 +0100
categories: [pinned, announcement]
author: Opusforlife & Poolitzer
image: newpipe
excerpt_separator: <!-- more -->
---

Hey there! Guess who is back? We. We are. Admittedly, we're quite a bit late with this one. But there is a _very_ good reason for that. Are you ready for it? Sit down, grab some popcorn and a beverage of your choice. This is going to be long.
<!-- more -->

## A new unified player

"What in the name of the coronavirus is the _unified player_?" you ask. Well, first of all, that's a very weird expression. Where did you even get that one from... - you know what? Nah. We don't want to know. You just keep on using that, we keep on talking about the new player.

A new player it indeed is. Up until now, NewPipe had three different players bundled in its code: the main, pop-up and background player. All three had separate code and separate playing queues. When you switched from one player to another, the stream would start from the beginning instead of carrying on from where you left. In the background, the old player and its queue closed itself, while the new one took over. If that sounds complicated and cumbersome, it does because it is. At least if you ask us.

Well, no more! Now, when you switch from one player to another, you resume _exactly_ where you left off, and even your playing queue carries over! Since there is only one player (although with all of the three different playing modes), there is only one queue as well. Ah, serendipity.

This was made possible by rewriting the code so that all players run on one common service. When you switch from one player to another, this service remains running, preserving the stream data, and the new player just picks up from where the old one left off.

### Video detail page

A more unified experience is not the only feature this change brought you. There is one which is immediately noticeable once you open a video in the new version: The video details page. Earlier, when you opened the video details, you were shown a thumbnail, video description, comments, etc., and tapping the thumbnail would open the player in fullscreen, hiding the rest of these informations. Now, when you're in portrait mode, the video plays right in the video details page - just like YouTube! There is even a new autoplay setting which plays the video automatically when you open video details - also just like YouTube! This setting will be turned on by default. Of course, you can turn it off if you prefer the behaviour of the previous versions.

### Video orientation

Thirdly, earlier, when you played a video, it would open in fullscreen regardless of your selected orientation. This was fine for landscape videos in landscape mode, and portrait videos in portrait mode, but it resulted in a lot of wasted space if the video's orientation didn't match the player's. Well, no more! There is now a fullscreen button which replaces the orientation switch button, and it is _smart_. It will detect if the video is landscape or portrait, and will ensure the player is in the correct orientation when you enter fullscreen! How's _that_ for convenience and usability? Not only that, but if auto-rotate is enabled, and the video is a landscape one, the button will disappear because you don't need it! (In portrait mode, you still need the button to go into fullscreen from the video details.)

Fourthly, you can now swipe down on the video in the video details page to _minimize_ it - just like Youtu- wait no. It's different. You get a minimized player at the bottom, and you can play/pause or even close it from there. How cool is that? The video will keep playing (or stay paused, if you prefer that) while you can browse NewPipe at your leisure! No more having to finish a video before browsing mindlessly! Yay distractions! (In landscape mode, you can swipe down on the title to minimize as well. The swipe area is confined to that region because the rest is used for the existing volume and brightness gestures, as you know.)

Since the player can now be minimized instead of closed, this means you get to retain your opened video queue! For example: let's say you watch a video, minimize it, then browse some, then watch another, minimize it, and then browse some more, and finally watch a third. As long as the minimized player isn't closed (by using the cross button or swiping down on it) you can tap back to go through those videos in reverse order! This allows you to browse a whole bunch of videos and quickly build up a video queue before you start watching them. (You could do this earlier, but you had to use the background or popup player queues as a workaround, because you couldn't manually enqueue videos in the main player.)

Fifthly (so many cool new things!), when you open a stream in the background player, you get a swanky new progress bar underneath the thumbnail!

All of what you've read above was made possible by the lean and mean coding machine, the one and only - (drumroll) - @avently! Seriously, you should all sacrifice your first born child in his name. We're already part of the cult. It's great. There's cakes and ice cream and free N95 masks. We're a very practical minded, but fun-loving cult, that way.

On a serious note, this was a massive, massive change to not only the code, but also the app workflow, and so this PR was tested and reviewed and modified several times, for a long period, before it saw the light of day. Mad props to @avently for having the patience and the dedication to keep adding features and bug fixes until everyone was satisfied! A lesser person would have gone insane! And a big thank you to the maintainers for doggedly reviewing this gigantic PR repeatedly! Those ~6600 additions and ~5600 removals must have looked very intimidating!

Naturally, since this was such a massive change, several bugs also slipped through. But @avently, with the help of @blackbox87, @Stypox, @TobiGr, (add more as they come), fixed them rapidly as they were reported. 

### The Notification is dead, long live the Notification!

If you care about such things, you would have noticed by now that NewPipe's notification looks quite different from most media player apps these days. It has a progress bar, buttons in odd places, and a permanent grey colour. This is because NewPipe uses an old API for notifications called RemoteView. This allowed for a lot of customisation, and that was good at the time it was in vogue. However, it has been deprecated, and has been superseded by another, more modern API.

Enter the Mediastyle notification:

This is a special notification type which has been available for media apps to use since Android Lollipop. In Oreo, it gained the ability to be coloured to match the colour theme of the cover art of the stream playing. And since Android 10, it has a seekbar built right into it! It is a powerful API that removes the need to use a whole bunch of custom code to achieve what we want. This will make it far easier to maintain and improve. Win for development!

So let's get on with what is new and what has changed. First of all, sorry users on Android 9 and below. The progress bar is gone. As we've said above, it will only be shown on Android 10+ now. Blame Google for introducing it so late! We're a small team and can't maintain code for the old and new type of notifications simultaneously, so the old one has to go. And not just that; the old notification isn't even supported Android 11 onwards. Bye-bye RemoteView notifications. We shall miss you! :'(

But you get a lot in exchange for that sacrifice!

You get five CUSTOMISABLE - you read it right! - _CUSTOMISABLE_ action buttons to control playback. There is a new Notification menu in Settings, and you can choose which button should carry which player action. Play/pause, forward/rewind, previous/next, shuffle, repeat, close, or even nothing!

Then, you can choose which three of these five buttons show in the compact notification (remember that little arrow you use to expand/reduce the notification?).

For users on Android 8+: Colours! Warm colours. Cool colours. All the colours! As we've noted above, Mediastyle notifications adapt to the colours of the cover art, which looks just plain awesome.

For users on Android 10+: Seekbar! The old notification had a progress bar, but that was just a visual indicator. Now you can actually seek from the notification itself. Congratulations! You must be the youngest Seeker in a centur - wrong universe. Sorry. Ignore that.

For users on Android 11: Congratulations. You get a notification now! :P

Kidding. (Well, not really.) Anyway, NewPipe's media session will show up in the notification shade and in Quick Settings just as advertised. There are still some bugs because we had to rush after Android 11 was released, but they'll be fixed pretty soon.

This cool contribution was brought to us in its nascent form by @cool-student. Sadly, we couldn't get in touch with him when we were ready to focus on this PR, so @wb9688 and @Stypox swooped in to save the day! @wb9688 updated the code to conform to our standards and coding style, and @Stypox did the (painstaking!) work of rebasing the code after the unified player PR was merged into the development branch.

Ultimately, @Stypox took over the responsibility for this PR. He updated and polished the UI, fixed bugs, got everyone and their grandfather to test the changes, and pulled us to the finish line!

-- Baton pass to Poolitzer--